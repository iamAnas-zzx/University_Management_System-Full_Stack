<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Madan Mohan Malaviya University of Technology, Gorakhpur (U.P.) India</title>
    <meta content="" name="description">
    <meta content="" name="keywords">


    <!-- Favicons -->
    <link href="/img/favicon.png" rel="icon">
    <link href="/img/apple-touch-icon.png" rel="apple-touch-icon">

    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
        rel="stylesheet">

    <!-- Bootstrap Link -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">


    <!-- Template Main CSS File -->
    <link href="/main.css" rel="stylesheet">
    <!-- JQuerry -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.6/dist/umd/popper.min.js"
        integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.2.1/dist/js/bootstrap.min.js"
        integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k"
        crossorigin="anonymous"></script>


    <!--Bootstrap JavaScript-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous">
        </script>


</head>

<body>
    <style>
        #title {
            position: relative;
            padding-top: 90px;
            /* height: 100vh; */

        }

        #title .container-xl {
            background: #e03a3c;
            border-radius: 25px;
            /* height: 85vh; */
        }

        #col-one button {
            width: 100%;
            padding: 0.5rem 0;
            margin: 1em 0;
        }

        #div-two {
            box-shadow: var(--shadow-elevation-low);
        }

        #selectBox {
            display: flex;
            justify-content: center;
            padding-top: 1rem;
        }

        #div-two .form-group h3 {
            font-size: 1rem;
            font-weight: 400;
            font-family: 'Open Sans', sans-serif;
            line-height: 1.5;
        }

        #editBox {
            display: none;
        }
    </style>
    <header id="header">

        <nav class="navbar navbar-expand-md navbar-light fixed-top bg-white ">
            <div class="container-fluid px-lg-5 ">
                <a id="head" class="navbar-brand" href="index.html"><img src="/img/favicon.png" alt="">M.M.M.U.T.</a>
                <li class="nav-link ">
                    <a href="/teacher/logout">Log Out</a>
                </li>

            </div>
        </nav>
    </header>
    <section id="title">
        <div class="container-xl">
            <div class="row " style="height: 100%;">
                <div id="col-one" class="col-2 pt-2">
                    <h3 class="text-center text-white ">Update Student Details</h3>
                    <div style="height: 2px;background: rgb(255, 100, 100);"></div>
                    <div>
                        <div>
                            <a href="/teacher/dashboard"><button class="btn btn-light ">Dashboard</button></a>
                        </div>
                        <div>
                            <a href="/teacher/update"><button class="btn btn-light ">Update Student Details</button></a>
                        </div>
                    </div>
                    <div style="height: 1px;background: rgb(50, 50, 50);"></div>
                    <div>
                        <a href="/teacher/password"><button class="btn btn-light ">Change Password</button></a>
                    </div>
                </div>
                <div id="col-two" class="col-10 p-2 ">
                    <div id="div-two" class="bg-white" style="border-radius: 20px;height: 100%;">
                        <div id="selectBox" >
                            <form action="/teacher/update" method="get">
                                <select id="subject" name="subject">
                                    <option value="" disabled selected>Select subject</option>
                                    <% for(let i=0 ; i < subjects.length ; i++) {%>
                                        <option value="<%= subjects[i] %>">
                                            <%= subjects[i] %>
                                        </option>
                                        <% } %>
                                </select>
                                <button type="submit">Search</button>
                            </form>
                        </div>

                        <% if(editData) { %>
                            <div id="editBox" class="row px-4 pt-2">
                                <form action="/teacher/update?_method=PUT" method="post">
                                    <div class="form-group col-md-6 mb-3 ">
                                        <h3>Subject</h3>
                                        <h3 ><%= subject %></h3>
                                    </div>
                                    <input type="hidden" name="hiddenSubject" id="hiddenSubject" value="">
                                    <div class="form-group col-md-6 mb-3">
                                        <h3>Roll number</h3>
                                        <h3 class="rollNo">
                                            <%= student.rollNumber %>
                                        </h3>
                                    </div>
                                    <input type="hidden" name="hiddenRollNumber" id="hiddenRollNumber" value="">
                                    <div class="form-group col-md-6 mb-3 ">
                                        <h3>Name</h3>
                                        <h3 class="name">
                                            <%= student.name %>
                                        </h3>
                                    </div>
                                    <input type="hidden" name="hiddenName" id="hiddenName" value="">
                                    <div class="form-group col-md-6 mb-3 ">
                                        <label for="Marks">Marks</label>
                                        <input type="text" name="marks" value="<%= marks %>" placeholder="" class="form-control">
                                    </div>
                                    <br>
                                    <div class="col pb-2">
                                        <button type="submit" class="btn btn-success">Update</button>
                                    </div>
                                    <hr>
                                </form>
                            </div>
                            <% } %>
                                <div class="row pt-2">
                                    <div class="col px-4">
                                        <table class="table table-bordered" id="dataTable">
                                            <thead>
                                                <tr>
                                                    <th>Roll number</th>
                                                    <th>Name</th>
                                                    <th>Marks</th>
                                                    <th>Action</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <% for (let i=0; i < students.length; i++) { %>
                                                    <tr>
                                                        <td>
                                                            <%= students[i].rollNumber %>
                                                        </td>
                                                        <td>
                                                            <%= students[i].name %>
                                                        </td>
                                                        <td>
                                                            <% for(let sub of students[i].Subjects) { %>
                                                                <% if(sub.subjectName===subject) {%>
                                                                    <%= sub.Marks %>
                                                                        <% } %>
                                                                            <% } %>
                                                        </td>
                                                        <td>
                                                            <a
                                                                href="/teacher/update?subject=<%= subject%>&rollNumber=<%= students[i].rollNumber%>"><button
                                                                    class="btn btn-warning">Edit</button></a>
                                                        </td>
                                                    </tr>
                                                    <% } %>

                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                    <!-- </div> -->
                    </div>
                </div>
            </div>
        </div>
    </section>
    <% if(editData) { %>
        <script>
            const editBox = document.querySelector('#editBox');
            editBox.style.display = 'block';
            const subject = document.querySelector("#hiddenSubject");
            const rollNo = document.querySelector("#hiddenRollNumber");
            const name = document.querySelector("#hiddenName");
            subject.value = '<%= subject %>' 
            rollNo.value = '<%= student.rollNumber %>';
            name.value = '<%= student.name %>';           
        </script>
        <% } %>
    